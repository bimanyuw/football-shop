document.addEventListener('DOMContentLoaded',()=>{const loginForm=document.getElementById('loginForm');const registerForm=document.getElementById('registerForm');async function handle(form,endpoint,successRedirect='/'){const data=new FormData(form);try{const res=await jsonFetch(endpoint,{method:'POST',body:data});showToast('Success',res.message||'OK','success');window.location.href=res.redirect||successRedirect;}catch(err){showToast('Error',err.message||'Gagal','error');}}if(loginForm){loginForm.addEventListener('submit',e=>{e.preventDefault();handle(loginForm,'/auth/login-ajax/','/');});}if(registerForm){registerForm.addEventListener('submit',e=>{e.preventDefault();handle(registerForm,'/auth/register-ajax/','/');});}});
