{% extends 'base.html' %}

{% block meta %}
<title>{% if is_edit %}Edit Product{% else %}Add Product{% endif %}</title>
{% endblock meta %}

{% block content %}
<div class="max-w-3xl mx-auto px-4 py-6">
  <!-- Back -->
  <div class="mb-6">
    <a href="{% url 'main:show_main' %}" class="text-[#000000] hover:text-[#8E1616] font-medium">
      ‚Üê Back
    </a>
  </div>

  <!-- Card -->
  <div class="bg-white border border-[#E8C999] rounded-lg p-6 shadow-sm form-style">
    <h1 class="text-2xl font-bold text-[#000000] mb-2">
      {% if is_edit %}Edit Product{% else %}Add Product{% endif %}
    </h1>
    <p class="text-gray-600 mb-6">
      {% if is_edit %}Perbarui informasi produkmu.{% else %}Tambahkan produk baru ke toko.{% endif %}
    </p>

    <!-- Error umum -->
    {% if form.non_field_errors %}
      <div class="mb-4 text-sm text-red-700 bg-red-50 border border-red-200 rounded p-3">
        {% for e in form.non_field_errors %}{{ e }}{% endfor %}
      </div>
    {% endif %}

    <form method="POST" class="space-y-5">
      {% csrf_token %}

      {% for field in form %}
        <div>
          <label for="{{ field.id_for_label }}" class="block text-sm font-medium text-[#000000] mb-1">
            {{ field.label }}
          </label>

          {% for error in field.errors %}
            <p class="text-sm text-red-600 mb-1">{{ error }}</p>
          {% endfor %}

          {{ field }}

          {% if field.help_text %}
            <p class="mt-1 text-xs text-gray-500">{{ field.help_text }}</p>
          {% endif %}
        </div>
      {% endfor %}

      <!-- Actions -->
      <div class="flex flex-col sm:flex-row gap-3 pt-6 border-t border-[#E8C999]/60">
        <a href="{% url 'main:show_main' %}"
           class="order-2 sm:order-1 px-5 py-2 rounded-md border border-[#E8C999] text-[#000000] hover:bg-[#E8C999] text-center transition">
          Cancel
        </a>
        <button type="submit"
                class="order-1 sm:order-2 px-5 py-2 rounded-md bg-[#8E1616] text-white hover:bg-[#000000] transition">
          {% if is_edit %}Update{% else %}Publish{% endif %}
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Style fallback untuk input agar sesuai tema -->
<script>
  (function(){
    document.querySelectorAll('.form-style input, .form-style select, .form-style textarea')
      .forEach(function(el){
        if (!el.className || !/px-4/.test(el.className)) {
          el.className += " w-full px-4 py-2 border border-[#E8C999] rounded-md " +
                          "focus:outline-none focus:border-[#8E1616] focus:ring-1 focus:ring-[#8E1616] " +
                          "transition";
        }
      });
  })();
</script>
{% endblock content %}
