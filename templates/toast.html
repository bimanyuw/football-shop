{% load static %}
<div 
  class="fixed bottom-8 right-8 p-4 px-8 rounded-xl shadow-xl z-50 opacity-0 transition-all duration-300 translate-y-64 flex items-center gap-4"
  id="toast-component">
  <span id="toast-icon" class="text-2xl"></span>
  <div>
    <h3 class="font-bold" id="toast-title">This is a Sample Title</h3>
    <p class="text-gray-700 text-sm line-clamp-3" id="toast-message">This is a Sample Message</p>
  </div>
</div>
<script src="{% static 'js/toast.js' %}"></script>
<script>
// helper CSRF (kalau belum ada)
function getCookie(name) {
  const value = `; ${document.cookie}`;
  const parts = value.split(`; ${name}=`);
  if (parts.length === 2) return parts.pop().split(';').shift();
}

// attach ke dua tombol (desktop + mobile) kalau ada
function bindAjaxLogout(id) {
  const el = document.getElementById(id);
  if (!el) return;
  el.addEventListener('click', async (e) => {
    e.preventDefault();
    try {
      const res = await fetch("{% url 'main:ajax_logout' %}", {
        method: 'POST',
        headers: { 'X-CSRFToken': getCookie('csrftoken') }
      });
      if (res.ok) {
        showToast('Logged out', 'Sampai jumpa!', 'success');
        window.location = "{% url 'main:login' %}";
      } else {
        showToast('Logout gagal', 'Coba lagi sebentar', 'error');
      }
    } catch (err) {
      console.error(err);
      showToast('Error', 'Koneksi bermasalah', 'error');
    }
  });
}

// jalankan setelah DOM siap
document.addEventListener('DOMContentLoaded', () => {
  bindAjaxLogout('btn-logout');
  bindAjaxLogout('btn-logout-mobile');
});
</script>
