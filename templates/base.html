{% load static %}
<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    {% block meta %}{% endblock meta %}
    <link rel="stylesheet" href="{% static 'css/global.css' %}">
    <!-- Tailwind via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- DOMPurify (sesuai tutorial: sanitasi di client) -->
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>
  </head>

  <body class="bg-[#F8EEDF] text-[#000000]">

    <!-- NAVBAR (fixed top) -->
    <nav class="fixed top-0 left-0 w-full z-50 bg-[#000000] text-white border-b border-[#E8C999]">
      <div class="max-w-7xl mx-auto px-4">
        <div class="h-14 flex items-center gap-4">
          <!-- Brand -->
          <a href="{% url 'main:show_main' %}" class="font-semibold whitespace-nowrap">
            <span class="text-[#8E1616]">Football</span>
            <span class="text-[#E8C999]">Shop</span>
          </a>

          <!-- Menu tengah -->
          <ul class="hidden md:flex flex-nowrap overflow-x-auto items-center gap-6 mx-4 text-sm whitespace-nowrap">
            <li><a href="{% url 'main:show_main' %}" class="hover:text-[#E8C999]">Home</a></li>
            <li><a href="{% url 'main:show_main' %}?filter=Shoes" class="hover:text-[#E8C999]">Shoes</a></li>
            <li><a href="{% url 'main:show_main' %}?filter=Accessories" class="hover:text-[#E8C999]">Accessories</a></li>
            <li><a href="{% url 'main:show_main' %}?filter=Jersey" class="hover:text-[#E8C999]">Jersey</a></li>
            <li>
              <!-- ganti ke modal AJAX -->
              <button type="button"
                      onclick="showModal()"
                      class="inline-block px-3 py-1 rounded bg-[#8E1616] hover:bg-[#E8C999] hover:text-[#000000] transition">
                Add Product
              </button>
            </li>
          </ul>

          <div class="flex-1"></div>

          <!-- User kanan -->
          <div class="hidden md:flex items-center gap-4 text-sm">
            {% if user.is_authenticated %}
              <span class="whitespace-nowrap">{{ user.username }}</span>
              <a href="{% url 'main:logout' %}" class="text-[#8E1616] hover:text-[#E8C999]">Logout</a>
            {% else %}
              <a href="{% url 'main:login' %}" class="hover:text-[#E8C999]">Login</a>
              <a href="{% url 'main:register' %}" class="hover:text-[#E8C999]">Register</a>
            {% endif %}
          </div>

          <!-- Hamburger -->
          <button type="button"
                  class="md:hidden p-2 rounded hover:bg-[#111]"
                  id="navBtn"
                  aria-label="Toggle menu"
                  aria-expanded="false">
            ☰
          </button>
        </div>

        <!-- Mobile dropdown -->
        <div id="navMenu" class="md:hidden hidden border-t border-[#E8C999] py-3 space-y-2 text-sm bg-[#000000]">
          <a href="{% url 'main:show_main' %}" class="block hover:text-[#E8C999]">Home</a>
          <a href="{% url 'main:show_main' %}?filter=Shoes" class="block hover:text-[#E8C999]">Shoes</a>
          <a href="{% url 'main:show_main' %}?filter=Accessories" class="block hover:text-[#E8C999]">Accessories</a>
          <a href="{% url 'main:show_main' %}?filter=Jersey" class="block hover:text-[#E8C999]">Jersey</a>

          <!-- ganti ke modal AJAX -->
          <button type="button"
                  onclick="showModal()"
                  class="inline-block px-3 py-1 rounded bg-[#8E1616] hover:bg-[#E8C999] hover:text-[#000000] transition">
            Add Product
          </button>

          {% if user.is_authenticated %}
            <div class="pt-2 text-gray-300">Hi, {{ user.username }}</div>
            <a href="{% url 'main:logout' %}" class="block text-[#8E1616]">Logout</a>
          {% else %}
            <a href="{% url 'main:login' %}" class="block hover:text-[#E8C999]">Login</a>
            <a href="{% url 'main:register' %}" class="block hover:text-[#E8C999]">Register</a>
          {% endif %}
        </div>
      </div>
    </nav>

    <!-- PAGE CONTENT (padding-top agar tidak ketutup navbar fixed) -->
    <main class="pt-16">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        {% block content %}{% endblock content %}
      </div>
    </main>

    <!-- Script toggle menu mobile -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const btn = document.getElementById("navBtn");
        const menu = document.getElementById("navMenu");
        if (!btn || !menu) return;

        btn.addEventListener("click", (e) => {
          e.stopPropagation();
          menu.classList.toggle("hidden");
          const expanded = btn.getAttribute("aria-expanded") === "true";
          btn.setAttribute("aria-expanded", (!expanded).toString());
        });

        // Klik di luar menu → auto close
        document.addEventListener("click", (e) => {
          if (!menu.classList.contains("hidden")) {
            const inside = e.target.closest("#navMenu") || e.target.closest("#navBtn");
            if (!inside) menu.classList.add("hidden");
          }
        });
      });
    </script>

    <!-- include komponen dari tutorial -->
    {% include 'toast.html' %}
    {% include 'modal.html' %}
  </body>
</html>
